function registerComponent(n,t){if(!n||""===n||stampComponents.hasOwnProperty(n))throw"Stamp Error: A unique name is required for a Component definition";stampComponents[n]=t}function registerLayout(n,t){if(!n||""===n||stampLayouts.hasOwnProperty(n))throw"Stamp Error: A unique name is required for a Layout definition";stampLayouts[n]=t}function registerTemplate(n,t){throw new Error("NotImplementedException")}!function(n){try{n=angular.module("stamp")}catch(t){n=angular.module("stamp",[])}n.run(["$templateCache",function(n){n.put("src/angular/templates/addComponentModal.html",'<div class="stamp-modal stamp-modal-add-component modal-content">\n  <div class="modal-header">\n    <button type="button" class="close" aria-label="Close" data-ng-click="close()"><span aria-hidden="true">&times;</span></button>\n    <h4 class="modal-title">Add Component</h4>\n  </div>\n  <div class="modal-body">\n    <div class="component-list">\n      <div class="component-list-item" data-ng-class="{\'no-icon\' : !value.icon}" data-ng-repeat="(key, value) in components" data-ng-click="insert(key)">\n        <i class="{{value.icon}}" data-ng-if="value.icon"></i>\n        <span>{{value.label}}</span>\n      </div>\n    </div>\n  </div>\n</div>')}])}(),"function"!=typeof Object.assign&&(Object.assign=function(n){"use strict";if(null==n)throw new TypeError("Cannot convert undefined or null to object");n=Object(n);for(var t=1;t<arguments.length;t++){var o=arguments[t];if(null!=o)for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&(n[e]=o[e])}return n}),function(n){try{n=angular.module("stamp")}catch(t){n=angular.module("stamp",[])}n.run(["$templateCache",function(n){n.put("src/angular/templates/block.html",'<div class="block-header clearfix">\n    <span class="pull-right">\n      <span uib-dropdown="">\n        <a href="" id="simple-dropdown" uib-dropdown-toggle="">Layout: {{layouts[data.attributes.layout].label}}</a>\n        <ul class="dropdown-menu" uib-dropdown-menu="" aria-labelledby="simple-dropdown">\n          <li data-ng-repeat="(key, value) in layouts">\n            <a data-ng-click="changeLayout(key)">{{key == \'fluid\' ? \'Remove Layout (Fluid)\' : value.label}}</a>\n          </li>\n        </ul>\n      </span>\n      <a data-ng-if="blockIndex !== 0" data-ng-click="moveUp()">&#9650;</a>\n      <a data-ng-if="blockIndex !== blockCount - 1" data-ng-click="moveDown()">&#9660;</a>\n      <a data-ng-click="remove()">X</a>\n    </span>\n</div>\n<div class="alert alert-danger" data-ng-if="layout.maxColumns && layout.maxColumns < data.columns.length">This layout has a column limit of {{layout.maxColumns}}, the column count is {{data.columns.length}}, switch to a {{data.columns.length}} column layout</div>\n<div class="block-body">\n  <div data-ng-class="getColumnClasses($index)" data-ng-repeat="column in data.columns track by $index">\n    <div class="stamp-component-wrapper component-{{$index}}" data-ng-repeat="component in column.components track by $index">\n      <stamp-component data="component" col-index="$parent.$index" com-index="$index" com-count="column.components.length"></stamp-component>\n    </div>\n    <div data-ng-if="!parent.locked && !parent.readOnly">\n      <input class="btn btn-warning btn-lg center-block" type="button" value="Remove Column" data-ng-if="column.components.length == 0" data-ng-click="removeColumn($index)">\n      <input class="btn btn-default btn-lg center-block" type="button" value="+ Component" data-ng-click="addComponent($parent.$index)">\n    </div>\n  </div>\n  <!-- enable this instead of the below option when you\'ve added the ability to add no middle column if 3 are missing on a 3 col layout <div ng-if="emptyColumnCount().length > 0" ng-class="getColumnClasses($index, true)" ng-repeat="emptyColumn in emptyColumnCount() track by $index">\n    <div ng-if="!parent.locked && !parent.readOnly"><input class="btn btn-default btn-lg center-block" type="button" ng-click="addColumn($index)" value="+ Column"></input></div>\n  </div>-->\n  <div data-ng-if="!parent.locked && !parent.readOnly && (emptyColumnCount().length > 0  && data.attributes.layout != \'fluid\' || data.attributes.layout == \'fluid\' && data.columns.length == 0)" data-ng-class="getColumnClasses(0, true)">\n    <input class="btn btn-default btn-lg center-block" type="button" value="+ Column" data-ng-click="addColumn()">\n  </div>\n</div>')}])}(),function(){var n=angular.module("stamp.mappers",["stamp.models"]);n.factory("StampJSON",["StampModels",function(n){function t(n){try{return o.parse(n)}catch(t){return void console.log("Warning! Failed to import Stamp json",t)}}var o={parse:function(n){return o.stack(n)},stack:function e(t){var e=new n.Stack;return t&&t.blocks?(t.blocks.forEach(function(n){var t=o.block(n);t&&e.add(t)}),e):e},block:function a(t){var a=new n.Block(t);return t.components?(t.components.forEach(function(n){var t=o.component(n);t&&a.add(t)}),a):a},component:function(t){var o=new n.Component(t);return o}};return{from:function(n){return console.log("Called stamp.mappers.json.from [JSON -> Stack]"),t(n)}}}])}(),function(n){try{n=angular.module("stamp")}catch(t){n=angular.module("stamp",[])}n.run(["$templateCache",function(n){n.put("src/angular/templates/component.html",'<div class="component-wrap">\n  <div class="component-header">\n    <p class="pull-right"><a data-ng-if="comIndex !== 0" data-ng-click="moveUp()">&#9650;</a> <a data-ng-if="comIndex !== comCount - 1" data-ng-click="moveDown()">&#9660;</a> <a data-ng-click="remove()">X</a></p>\n  </div>\n  <div class="alert alert-danger" data-ng-if="componentError">{{componentError}}</div>\n  <div class="component-body">\n  </div>\n</div>')}])}(),function(){function n(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}var t=angular.module("stamp",["stampSetup","ui.bootstrap"]);t.value("stampConfig",{}),t.directive("stampEditor",["$rootScope","$compile","$timeout","$window","stampConfig",function(n,t,o,e,a){a=a||{};var l=0,c="ui-stamp-editor-";return{require:"ngModel",templateUrl:"../src/angular/templates/editor.html",link:function(n,t,o,e){function s(){n.locked=o.locked}function i(){n.readOnly=o.readOnly}var u={},r={};n.json={},o.$set("id",c+l++),console.log("Stamp directive given ID: "+c+l),angular.extend(r,n.$eval(o.stampOptions)),angular.extend(u,a,r),n.attributes=Object.assign({locked:!1,readOnly:!1},{locked:!!o.locked,readOnly:!!o.readOnly},u),o.$observe("locked",s),o.$observe("readOnly",i),o.ngModel?(n.$watch(o.ngModel,function(n,t){console.log("ngModel value changed via attr watch",t,n)}),n.$watch(function(){return JSON.stringify(e.$viewValue)},function(n,t){console.log("ngModel value changed via view watch")}),e.$viewChangeListeners.push(function(){console.log("ngModel value changed via Listener")}),e.$render=function(){console.log("ng-model render called")},e.$parsers.push(function(n){console.log("ng-model parser called");var t=e.$viewValue;return t}),e.$formatters.push(function(n){console.log("ng-model formatter called");var t=e.$modelValue;return t}),n.$watch(function(){return JSON.stringify(e.$modelValue)},function(t,o){console.log("ngModel value changed via model watch"),n.json=e.$modelValue})):console.log("Warning: missing ng-model definition on stamp editor"),n.addBlock=function(t){n.json.blocks.splice(void 0!==t?t:n.json.blocks.length,0,{attributes:{},columns:[]})}},controller:["$scope",function(n){this.removeBlock=function(t){n.json.blocks.splice(t,1)},this.moveBlock=function(t,o){var e=n.json.blocks.splice(t,1);n.json.blocks.splice(o,0,e[0])}}]}}]),t.directive("stampAutoHeight",function(n){return{restrict:"A",link:function(t,o){var e=function(){var n=o[0].scrollHeight;25>n?o[0].style.height="25px":(n+=10,o[0].style.height=n+"px")};t.$on("layoutChanged",function(){o[0].style.height="auto",n(e,10)}),n(e,0)}}}),t.directive("stampBlock",["stampLayouts","$uibModal",function(n,t){return{restrict:"E",require:"^stampEditor",templateUrl:"../src/angular/templates/block.html",scope:{data:"=",blockIndex:"=",blockCount:"="},link:function(o,e,a,l){function c(t,e){return o.layout=n[e],o.blockError=!1,o.layout?(void 0!==o.layout.maxColumns&&o.layout.maxColumns<o.data.columns.length&&(o.blockError="This layout has a column limit of "+o.layout.maxColumns+", the column count is "+o.data.columns.length),console.log("broadcasting"),void o.$broadcast("layoutChanged",o.data.attributes.layout)):void(o.blockError="Stamp markup requires missing layout: "+e)}o.layouts=n,o.$watch(function(){return o.data.attributes.layout},function(n,t){t!==n&&c(t,n)}),o.data.attributes=o.data.attributes||{},o.data.attributes.layout=o.data.attributes.layout||"fluid",c(void 0,o.data.attributes.layout),o.getColumnClasses=function(n,t){t&&(n+=o.data.columns.length-1);var e="stack-column column-"+n+" ";if(void 0===o.layout.columnStyles)e+="col-md-12";else if(angular.isObject(o.layout.columnStyles)){for(var a in o.layout.columnStyles)if(o.layout.columnStyles.hasOwnProperty(a)){var l=o.layout.columnStyles[a];if(angular.isArray(l)){var c=n>l.length-1?l.length-1:n;e+="col-"+a+"-"+l[c]}else e+="col-"+a+"-"+l;e+=" "}}else e+="col-"+o.layout.columnStyles;return e},o.addComponent=function(n){var e=t.open({templateUrl:"../src/angular/templates/addComponentModal.html",controller:"StampAddComponentModalInstanceCtrl"});e.result.then(function(t){o.data.columns[n].components.push({type:t,data:{}})})},o.moveUp=function(){l.moveBlock(o.blockIndex,o.blockIndex-1)},o.moveDown=function(){l.moveBlock(o.blockIndex,o.blockIndex+1)},o.remove=function(){l.removeBlock(o.blockIndex)},o.changeLayout=function(n){if("fluid"===n)for(;o.data.columns.length>1;){var t=o.data.columns.pop();o.data.columns[0].components=o.data.columns[0].components.concat(t.components)}o.data.attributes.layout=n},o.emptyColumnCount=function(){if(!o.layout.maxColumns)return new Array(0);var n=o.layout.maxColumns-o.data.columns.length;return new Array(n>-1?n:0)},o.addColumn=function(){o.data.columns.push({components:[]})},o.removeColumn=function(n){o.data.columns.splice(n,1)}},controller:["$scope",function(n){this.removeComponent=function(t,o){n.data.columns[t].components.splice(o,1)},this.moveComponent=function(t,o,e,a){var l=n.data.columns[t].components,c=l.splice(e,1);n.data.columns[o].components.splice(a||0,0,c[0])}}]}}]),t.controller("StampAddComponentModalInstanceCtrl",["$scope","$uibModalInstance","stampComponents",function(n,t,o){n.components=o,n.insert=function(n){t.close(n)},n.close=function(){t.dismiss()}}]),t.directive("stampComponent",["$compile","stampComponents",function(t){return{restrict:"E",require:"^stampBlock",templateUrl:"../src/angular/templates/component.html",scope:{data:"=",index:"=",colIndex:"=",comIndex:"=",comCount:"="},link:function(o,e,a,l){function c(){var a=stampComponents[o.data.type];if(!a)return void(o.componentError="No component registered for type: "+o.data.type);var l=n(a.directive),c="<"+l+' data="data.data"></'+l+">",s=angular.element(e[0].getElementsByClassName("component-body")[0]);s.empty(),s.append(t(angular.element(c))(o))}return o.data&&o.data.type?(o.$watch("data.type",function(n,t){n!==t&&c()}),c(),o.remove=function(){l.removeComponent(o.colIndex,o.comIndex)},o.moveUp=function(){l.moveComponent(o.colIndex,o.colIndex,o.comIndex,o.comIndex-1)},void(o.moveDown=function(){l.moveComponent(o.colIndex,o.colIndex,o.comIndex,o.comIndex+1)})):void(o.componentError="Missing required component data")}}}])}(),function(n){try{n=angular.module("stamp")}catch(t){n=angular.module("stamp",[])}n.run(["$templateCache",function(n){n.put("src/angular/templates/editor.html",'<div class="stamp-stack-container">\n <!-- {{json | json}} -->\n  <div class="stamp-block-wrapper block-{{$index}} row" data-ng-repeat="block in json.blocks">\n    <stamp-block data="block" block-index="$index" block-count="json.blocks.length" class="clearfix"></stamp-block>\n  </div>\n  <div class="no-config" data-ng-if="!json.blocks || json.blocks.length == 0">No Blocks</div>\n  <div data-ng-if="!locked && !readOnly"><input class="btn btn-default btn-lg center-block" type="button" value="+ Block" data-ng-click="addBlock()"></div>\n</div>')}])}();var stampComponents={},stampLayouts={},stampTemplates={};angular.module("stampSetup",[]).constant("stampRegister",{component:registerComponent,layout:registerLayout,template:registerTemplate}).value("stampComponents",stampComponents).value("stampLayouts",stampLayouts).value("stampTemplates",stampTemplates).value("stampOptions",{}).value("stampTranslations",{}).run(["stampRegister","$window","stampTranslations","stampOptions",function(n,t,o,e){n.layout("fluid",{label:"Fluid",maxColumns:void 0}),n.layout("oneColumn",{label:"One Column",maxColumns:1,columnStyles:{md:12}}),n.layout("twoColumn",{label:"Two Even Columns",maxColumns:2,columnStyles:{md:6,sm:12}}),n.layout("threeColumn",{label:"Three Columns",maxColumns:3,columnStyles:{md:4,sm:12}}),n.component("text",{directive:"stampTextComponent",label:"Text",icon:"fa fa-paragraph"}),n.component("title",{directive:"stampHeadingComponent",label:"Title",icon:"fa fa-header"})}]).directive("stampTextComponent",["$compile",function(n){return{restrict:"E",template:'<textarea stamp-auto-height placeholder="Enter Text.." class="form-control" ng-model="data.value"></textarea>',scope:{data:"="}}}]).directive("stampHeadingComponent",["$compile",function(n){return{restrict:"E",template:'<div class="input-group size-h{{data.size || 1}}">                <input type="text" placeholder="Enter Heading Text.." class="form-control" ng-model="data.value">                <div class="input-group-btn" uib-dropdown>                  <button type="button" class="btn btn-default" uib-dropdown-toggle>{{"H" + data.size}} <span class="caret"></span></button>                  <ul class="dropdown-menu" uib-dropdown-menu>                    <li ng-repeat="size in [1, 2, 3]"><a ng-click="data.size = size">{{"H" + size}}</a></li>                  </ul>                </div>              </div>',scope:{data:"="},link:function(n){void 0===n.data.size&&(n.data.size=1)}}}]);