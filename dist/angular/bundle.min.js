"use strict";function registerComponent(t,n){if(!t||""===t||stampComponents.hasOwnProperty(t))throw"Stamp Error: A unique name is required for a Component definition";stampComponents[t]=n}function registerLayout(t,n){if(!t||""===t||stampLayouts.hasOwnProperty(t))throw"Stamp Error: A unique name is required for a Layout definition";stampLayouts[t]=n}function registerTemplate(t,n){throw new Error("NotImplementedException")}"function"!=typeof Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");t=Object(t);for(var n=1;n<arguments.length;n++){var o=arguments[n];if(null!=o)for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e])}return t}),function(t){try{t=angular.module("stamp")}catch(n){t=angular.module("stamp",[])}t.run(["$templateCache",function(t){t.put("src/angular/templates/block.html",'<div data-ng-class="getColumnClasses($index)" data-ng-repeat="column in data.columns track by $index">\n  <div class="stack-component component-{{$index}}" data-ng-repeat="component in column.components track by $index">\n     <stamp-component data="component" col-index="$parent.$index" com-index="$index"></stamp-component>\n  </div>\n  <div data-ng-if="!parent.locked && !parent.readOnly"><input class="btn btn-default" type="button" value="+ Component" data-ng-click="addComponent($parent.$index)"></div>\n</div>')}])}(),function(){var t=angular.module("stamp.mappers",["stamp.models"]);t.factory("StampJSON",["StampModels",function(t){function n(t){try{return o.parse(t)}catch(n){return void console.log("Warning! Failed to import Stamp json",n)}}var o={parse:function(t){return o.stack(t)},stack:function e(n){var e=new t.Stack;return n&&n.blocks?(n.blocks.forEach(function(t){var n=o.block(t);n&&e.add(n)}),e):e},block:function a(n){var a=new t.Block(n);return n.components?(n.components.forEach(function(t){var n=o.component(t);n&&a.add(n)}),a):a},component:function(n){var o=new t.Component(n);return o}};return{from:function(t){return console.log("Called stamp.mappers.json.from [JSON -> Stack]"),n(t)}}}])}(),function(t){try{t=angular.module("stamp")}catch(n){t=angular.module("stamp",[])}t.run(["$templateCache",function(t){t.put("src/angular/templates/component.html",'<div class="component-wrap">\n  <div class="component-header">\n    <!--<p class="h4" ng-bind="name"></p>-->\n    <controls><!--<span class="fa fa-cog" ng-click="edit()"></span>--><span class="fa fa-times" data-ng-click="remove()"></span></controls>\n  </div>\n  <div class="alert alert-danger" data-ng-if="error">{{error}}</div>\n  <div class="component-body">\n    <div data-ng-if="componentError">{{componentError}}</div>\n  </div>\n</div>')}])}(),function(){function t(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}var n=angular.module("stamp",["stampSetup"]);n.value("stampConfig",{}),n.directive("stampEditor",["$rootScope","$compile","$timeout","$window","stampConfig",function(t,n,o,e,a){a=a||{};var l=0,r="ui-stamp-editor-";return{require:"ngModel",templateUrl:"../src/angular/templates/editor.html",link:function(t,n,o,e){function s(){t.locked=o.locked}function c(){t.readOnly=o.readOnly}var i={},u={};t.json={},o.$set("id",r+l++),console.log("Stamp directive given ID: "+r+l),angular.extend(u,t.$eval(o.stampOptions)),angular.extend(i,a,u),t.attributes=Object.assign({locked:!1,readOnly:!1},{locked:!!o.locked,readOnly:!!o.readOnly},i),o.$observe("locked",s),o.$observe("readOnly",c),o.ngModel?(t.$watch(o.ngModel,function(t,n){console.log("ngModel value changed via attr watch",n,t)}),t.$watch(function(){return JSON.stringify(e.$viewValue)},function(t,n){console.log("ngModel value changed via view watch")}),e.$viewChangeListeners.push(function(){console.log("ngModel value changed via Listener")}),e.$render=function(){console.log("ng-model render called")},e.$parsers.push(function(t){console.log("ng-model parser called");var n=e.$viewValue;return n}),e.$formatters.push(function(t){console.log("ng-model formatter called");var n=e.$modelValue;return n}),t.$watch(function(){return JSON.stringify(e.$modelValue)},function(n,o){console.log("ngModel value changed via model watch"),t.json=e.$modelValue})):console.log("Warning: missing ng-model definition on stamp editor")},controller:["$scope",function(t){}]}}]),n.directive("stampBlock",["stampLayouts",function(t){return{restrict:"E",require:"^stampEditor",templateUrl:"../src/angular/templates/block.html",scope:{data:"="},link:function(n,o,e,a){function l(o,e){return n.layout=t[e],n.error=!1,n.layout?void(void 0!==n.layout.maxColumns&&n.layout.maxColumns<n.data.columns.length&&(n.error="This layout has a column limit of "+n.layout.maxColumns+", the column count is "+n.data.columns.length)):void(n.error="Stamp markup requires missing layout: "+e)}n.$watch(function(){return n.data.attributes.layout},function(t,n){n!==t&&l(n,t)}),n.data.attributes=n.data.attributes||{},n.data.attributes.layout=n.data.attributes.layout||"fluid",l(void 0,n.data.attributes.layout),n.getColumnClasses=function(t){var o="stack-column column-"+t+" ";if(void 0===n.layout.columnStyles)o+="no-col-styles";else if(angular.isObject(n.layout.columnStyles))for(var e=0,a=n.layout.columnStyles.length;a>e;e++){var l=n.layout.columnStyles[e];if(angular.isArray(l)){var r=t>l.length-1?l.length-1:t;o+="col-"+n.layout.columnStyles[r]}else o+="col-"+n.layout.columnStyles}else o+="col-"+n.layout.columnStyles;return o},n.addComponent=function(t){}},controller:["$scope",function(t){this.removeComponent=function(t,n){console.log("TODO")}}]}}]),n.directive("stampComponent",["$compile",function(n){return{restrict:"E",require:"^stampBlock",templateUrl:"../src/angular/templates/component.html",scope:{data:"=",index:"="},link:function(o,e,a,l){if(!o.data||!o.data.type)return void(o.componentError="Missing vital component data");var r=t(o.data.type),s="<"+r+' data="data"></'+r+">",c=n(s)(o);e[0].getElementsByClassName("component-body")[0].appendChild(c[0]),o.remove=function(t,n){l.removeComponent(t,n)}}}}])}(),function(t){try{t=angular.module("stamp")}catch(n){t=angular.module("stamp",[])}t.run(["$templateCache",function(t){t.put("src/angular/templates/editor.html",'<div class="stamp-stack-container">\n  {{json | json}}\n  <div class="stack-block block-{{$index}}" data-ng-repeat="block in json.blocks">\n    <stamp-block data="block" index="$index"></stamp-block>\n  </div>\n  <div class="no-config" data-ng-if="!json.blocks || json.blocks.length == 0">No Blocks</div>\n  <div data-ng-if="!locked && !readOnly"><input class="btn btn-default" type="button" value="+ Block" data-ng-click="addBlock()"></div>\n</div>')}])}();var stampComponents={},stampLayouts={},stampTemplates={};angular.module("stampSetup",[]).constant("stampRegister",{component:registerComponent,layout:registerLayout,template:registerTemplate}).value("stampComponents",stampComponents).value("stampLayouts",stampLayouts).value("stampTemplates",stampTemplates).value("stampOptions",{}).value("stampTranslations",{}).run(["stampRegister","$window","stampTranslations","stampOptions",function(t,n,o,e){t.layout("fluid",{icon:"tint",label:"Fluid",maxColumns:void 0}),t.layout("oneColumn",{icon:"square",label:"One Column",maxColumns:1,columnStyles:{md:12}}),t.layout("twoColumn",{icon:"pause",label:"Two Even Columns",maxColumns:2,columnStyles:{md:6,sm:12}}),t.layout("threeColumn",{icon:"todo",label:"Three Columns",maxColumns:3,columnStyles:{md:4,sm:12}}),t.component("text",function(){return{directive:"stampTextComponent",icon:"text"}}),t.component("title",function(){return{directive:"stampTitleComponent",icon:"title"}})}]);